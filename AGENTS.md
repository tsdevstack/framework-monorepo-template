# Project Guide

## What This Is

A TypeScript microservices monorepo built with [tsdevstack](https://tsdevstack.dev).

## MCP Server

This project has an MCP server that provides tools for managing services, infrastructure, secrets, and deployments. It gives you access to all framework operations without needing to know individual CLI commands.

To use it, ensure your AI tool is configured to read `.mcp.json` from the project root. The server runs via:
```
npx tsdevstack mcp:serve
```

## Project Structure

```
apps/           — Microservices (NestJS backends, Next.js frontends, SPAs)
packages/       — Shared libraries (imported by apps)
infrastructure/ — Kong gateway config, Terraform (generated)
.tsdevstack/    — Framework configuration
```

Each app and package is an independent workspace with its own `package.json`, `tsconfig.json`, linter config, and tests.

## Available Commands

```bash
npx tsdevstack sync             # Regenerate all local config (docker-compose, kong, secrets)
npx tsdevstack add-service      # Scaffold a new service (NestJS, Next.js, or SPA)
npx tsdevstack generate-secrets # Generate local development secrets
npx tsdevstack generate-kong    # Regenerate Kong gateway config from OpenAPI specs
npx tsdevstack generate-client  # Generate TypeScript HTTP client from a service's OpenAPI spec
npx tsdevstack --help           # See all commands
```

## Local Development

```bash
docker compose up -d     # Start databases, Redis, Kong gateway
npm run dev              # Start all services in dev mode (parallel)
```

Individual service commands (run from repo root):
```bash
npm run build -w <service-name>   # Build a specific service
npm run lint -w <service-name>    # Lint a specific service
npm run tsc -w <service-name>     # Type-check a specific service
npm run test -w <service-name>    # Run tests for a specific service
```

## Build Order

Shared packages (`packages/*`) must be built before apps that depend on them:
```bash
npm run build:libs    # Build all packages
npm run build:apps    # Build all apps
npm run build         # Build everything (libs first, then apps)
```

## Configuration

- `.tsdevstack/config.json` — Framework config (services, cloud provider, project metadata)
- `docker-compose.yml` — Generated by `npx tsdevstack sync` (do not edit directly)
- `infrastructure/kong/` — Kong gateway Docker image with OIDC plugin
